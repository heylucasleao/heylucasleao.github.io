---
{"dg-publish":true,"permalink":"/digital-garden/path-for-the-true-and-brave/text/6-dag/"}
---

# DAG

O Modelo Gráfico Acíclico Direcionado (DAG) é uma ferramenta visual e matemática essencial na inferência causal moderna. Ele é crucial em contextos observacionais, onde experimentos controlados (RCTs) são inviáveis ou antiéticos. Seu propósito principal é explicitar suposições causais, pois permite identificar caminhos de confusão, determinar quais variáveis ajustar e orientar estratégias de identificação.

## 1. Fundamentos Estruturais

- **Nós (Variáveis):** Cada nó representa uma variável aleatória. A estrutura é definida pela **Independência Condicional**. O DAG traduz relações causais em restrições estatísticas testáveis.

>[!note]
>Algebricamente, a Probabilidade Condicional $P(B|A)$ na teoria dos conjuntos é análoga à correlação parcial $r(X,Y)|Z$ usada em algoritmos de descoberta causal (como o _Inductive Causality_).

- **Arestas (Relações $\rightarrow$):** Indicam a direção da causalidade. $A \rightarrow B$ implica que $A$ causa $B$. O DAG foca na **Causalidade Regular** (graus mensuráveis de influência) em vez da Causalidade Estrita determinística.

- Aciclicidade (Não Cíclico): É a regra fundamental. Não pode haver um ciclo fechado (por exemplo, $A \rightarrow B$ e $B \rightarrow A$). Isso impõe uma ordem temporal e causal clara, garantindo que o modelo seja computável para inferência.
## 2. A Mecânica: D-Separação

A d-separação ("d" de direcional) é o critério gráfico que determina se um fluxo de informação entre duas variáveis está bloqueado ou aberto. Se todas as trilhas entre $D$ e $Y$ são bloqueadas por um conjunto $Z$, dizemos que $D \perp \!\! \perp Y | Z$.

**Regras de Bloqueio de Caminho:**

1. **Cadeia ($D \rightarrow Z \rightarrow Y$) ou Garfo ($D \leftarrow Z \rightarrow Y$):**
    
    - O caminho está **aberto** por padrão.
    - O caminho é **bloqueado** se condicionarmos (controlarmos) o nó intermediário $Z$.
2. **Colisor ($D \rightarrow Z \leftarrow Y$):**
    
    - O caminho está **bloqueado** por padrão (as setas colidem).
    - O caminho é **aberto** se condicionarmos o colisor $Z$ (ou qualquer descendente dele). Isso cria uma dependência espúria.

> [!tip] Validação com Dados
> A d-separação teórica ($D \perp \!\! \perp Y | Z$) deve refletir uma independência estatística nos dados. Testamos isso verificando se a correlação parcial entre $D$ e $Y$ dado $Z$ ($\rho_{DY \cdot Z}$) é próxima de zero.
> 
> Uma explicação de correlação parcial pode ser vista via _[Mastering Mostly Harmless Econometrics - Part 2](https://www.aeaweb.org/webcasts/2020/mastering-mostly-harmless-econometrics-part-2)_ a partir de 1:08:30.
> 
> ![dag_1.png](/img/user/digital-garden/path-for-the-true-and-brave/assets/dag_1.png)
> _[Estatística Psicobio II 2024 #24 - DAG II Directed Acyclic Graphs - d' separation; algoritmo PC e IC](https://www.youtube.com/watch?v=PD_891dshAE&list=PLZjaOxYREinu5j6wg-KEpD8xSdhRqEdwl&index=6&pp=iAQB)_

## 3. Identificação e Critério Backdoor

O objetivo final é isolar o efeito causal de $D$ em $Y$, eliminando vieses.

- Caminho Backdoor (Porta dos Fundos): Qualquer caminho entre $D$ e $Y$ que começa com uma seta apontando para $D$ (ex: $D \leftarrow V \rightarrow Y$). Isso representa uma causa comum que gera correlação não-causal, que é a variável de confusão.
    
- **Critério Backdoor:** Para identificar o efeito causal, devemos selecionar um conjunto de variáveis que, ao serem condicionadas, bloqueiam todos os caminhos backdoor sem abrir novos caminhos (como colisor).

> [!note] Analogia: DAG vs. RCT
> 
> Enquanto o Experimento Randomizado (RCT) elimina vieses pelo design (randomização quebra as setas chegando em $D$), o DAG permite eliminar vieses na análise, simulando uma intervenção ($do(D)$) através do ajuste estatístico correto.

## 4. Classificação de Variáveis e Seleção de Controles

Classificar a variável corretamente é vital para saber se ela é um "Bom Controle" ou um "Mau Controle".
### A. Confounder (Confusão / Causa Comum)

Ancestral comum da exposição ($D$) e do desfecho ($Y$).

- **Estrutura:** $D \leftarrow V \rightarrow Y$
- **Problema:** Cria um caminho não-causal, enviesando a estimativa.
- **Ação:** **Condicionar (Controlar).** Devemos fechar essa porta para limpar o efeito.
### B. Mediador

Descendente da exposição e ancestral do desfecho. Está no caminho causal.

- **Estrutura:** $D \rightarrow V \rightarrow Y$
- **Função:** Explica _como_ $D$ afeta $Y$.
- **Ação:** **NÃO Condicionar** (se o objetivo é o efeito total). Controlar o mediador bloqueia o fluxo causal legítimo (overcontrol bias).
### C. Colisor

Descendente comum da exposição e do desfecho.

- **Estrutura:** $D \rightarrow V \leftarrow Y$
- **Problema:** Por natureza, ele já bloqueia o caminho.
- **Ação:** **NÃO Condicionar.** Se controlarmos o colisor, abrimos o caminho e criamos o **Viés de Seleção** (ou Viés de Colisor).
## 5. Boas Práticas e Leituras

O sucesso da inferência causal depende mais do desenho e das suposições teóricas (o DAG) do que da modelagem estatística em si. Definir "bons" e "maus" controles é a chave para evitar paradoxos estatísticos.

> [!abstract] Leituras Recomendadas
> - _[Causal assumptions: Think first, regress later](https://www.everydaycausal.com/causal-assumptions.html)_
> - _[A Crash Course in Good and Bad Controls](https://ftp.cs.ucla.edu/pub/stat_ser/r493.pdf)_
> - [The Book of Why - Cap. 05](https://www.amazon.com.br/Book-Why-Science-Cause-Effect/dp/1541698967/ref=sr_1_1?adgrpid=126456897803&dib=eyJ2IjoiMSJ9.77Kcrbw5e-DGGNNcwPR_y_7cv6iF2gyXhlgd60YaRYyxLXHZx_ePvacqi6vAk6o-4T6AAhmObdKajUcP7f37IZM94kZ95HHmq2GocaUxGiHYYHwqzVXuZnOenVPKrjfXEISw3UCBk6hJYrxNhrIWzVBLAKbdCdlX-8Hcr378LnOQBshMCgo9kQ9CIti3l8ZCYpn2CWxyAuO8_nisnap3FqTdhpLeWrDSrmdXRSbt93FBx27hzjvkx0n_IwQ96G4IzM8Y8tqie79hDgkBgPBpUaGPqeUkygy5h0Vm1Gi5yFU.ga6_v972wOeqiaC-MIX89ss5_6h8zghAy4vB3wa7Y00&dib_tag=se&hvadid=543845286867&hvdev=c&hvlocphy=9101224&hvnetw=g&hvqmt=e&hvrand=5958914465439584538&hvtargid=kwd-300942500351&hydadcr=14662_10954484&keywords=the+book+of+why&mcid=8028456292c1353ab874d4867e649d93&qid=1769521984&sr=8-1&ufe=app_do%3Aamzn1.fos.6d798eae-cadf-45de-946a-f477d47705b9)
> - **Vídeos de Apoio:**
>     - _[Mastering Mostly Harmless Econometrics - Part 2](https://www.aeaweb.org/webcasts/2020/mastering-mostly-harmless-econometrics-part-2)_ (Minuto 1:08:30 - Correlação Parcial)
>     - _[Estatística Psicobio II - d-separation & Algoritmo PC](https://www.youtube.com/watch?v=PD_891dshAE&list=PLZjaOxYREinu5j6wg-KEpD8xSdhRqEdwl&index=6&pp=iAQB)_
