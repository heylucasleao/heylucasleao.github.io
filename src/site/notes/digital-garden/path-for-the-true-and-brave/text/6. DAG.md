---
{"dg-publish":true,"permalink":"/digital-garden/path-for-the-true-and-brave/text/6-dag/"}
---

# DAG

O Modelo Gráfico Acíclico Direcionado (DAG) é uma ferramenta visual e matemática essencial na moderna teoria da inferência causal, especialmente em contextos observacionais onde experimentos são inviáveis ou antiéticos. Seu propósito principal é tornar explícitas as suposições causais: identificar caminhos que geram confusão, indicar quais variáveis devem ser ajustadas e orientar estratégias de identificação, como caminhos backdoor.

# Fundamentos Estruturais

- Nós (Variáveis): Cada nó no gráfico representa uma variável aleatória. A estrutura do DAG é definida com base na Independência Condicional entre as variáveis, que é o conceito-chave da moderna inferência causal. Ele permite traduzir as relações causais em restrições estatísticas testáveis. Na teoria dos conjuntos, o conceito de Probabilidade Condicional $P(B|A)$ – que define a relação entre conjuntos de eventos – é análogo algebricamente a correlação parcial $r(X,Y)Z$ que é usada em algoritmos de aprendizado de estrutura causal, como o Inductive Causality.
- Arestas (Relações $\rightarrow$): As setas indicam a direcionalidade da causalidade. $A \rightarrow B$ significa que $A$ é uma causa direta de $B$. O DAG representa a Causalidade Regular, focada em graus mensuráveis (gradação) de causalidade, diferentemente da Causalidade Estrita (classificação 0 ou 1).
- Aciclicidade (Não Cíclico): É a regra fundamental. Não pode haver um ciclo fechado (por exemplo, $A \rightarrow B$ e $B \rightarrow A$). Isso impõe uma ordem temporal e causal clara, garantindo que o modelo seja computável para inferência.

# Objetivos

- Visualizar caminhos entre tratamento $D$ e desfecho $Y$: o DAG expõe todos os caminhos (causais e não causais) que conectam $D$ e $Y$, permitindo identificar fontes potenciais de viés.

- Identificação de variáveis de confusão: Conseguir localizar variáveis que são causas tanto de $D$ quanto de $Y$ e, portanto, que precisam ser consideradas ao estimar o efeito causal.

- Aplicar o critério do backdoor: ele fornece uma regra gráfica para encontrar conjuntos de variáveis que, se condicionados, bloqueiam todos os caminhos não causais entre $D$ e $Y$, permitindo identificar o efeito causal de $D$ em $Y$.
    - Um caminho backdoor é um caminho entre $D$ e $Y$ que começa com uma seta apontando para $D$ (exemplo: $D \leftarrow V \rightarrow Y$). Se esse caminho não for bloqueado, ele causa viés de confounding.
    - Ao controlar (condicionar) a variável $V$ neste exemplo, o caminho traseiro é bloqueado, e a associação restante entre $D$ e $Y$ pode ser interpretada como o **efeito causal** de $D$ em $Y$.
> [!tip]
> Identificação Causal via Backdoor: O objetivo do ajuste de backdoor é simular uma intervenção física (o operador $do(x)$) usando apenas dados observacionais. Ao bloquear os caminhos backdoor, eliminamos a "contaminação" das associações espúrias, permitindo que a correlação restante seja interpretada como o efeito causal puro, aproximando o estudo observacional dos resultados de um Experimento Controlado Aleatorizado (RCT).

Em essência, enquanto o RCT tenta eliminar os vieses por meio da randomização no *design* do estudo, o DAG ajuda a identificar e bloquear os confoundings por meio de ajustes na *análise* dos dados observacionais.

# D-Separação

A d‑separação é o critério gráfico que determina se um conjunto Z bloqueia todos os caminhos entre X e Y, implicando $X \perp \!\! \perp Y | Z$. Regras essenciais sobre bloqueio de um caminho:
- Cadeia, garfo ou causa comum ($X \rightarrow V \rightarrow Y$ ou $X \leftarrow V \rightarrow Y$): o caminho é bloqueado se o nó intermediário (B) estiver condicionado.
- Um colisor ou efeito comum ($X \rightarrow V \leftarrow Y$): o caminho é bloqueado se o colisor B NÃO for condicionado; condicionar o colisor (ou um de seus descendentes) abre o caminho (isto é, cria dependência).

Se todo caminho entre X e Y for bloqueado por Z, então X e Y são d‑separados por Z no gráfico.

> [!tip] 
> **Exemplo:** A afirmação de que X e Y são d-separados por Z - $X \perp \!\! \perp Y | Z$ - é testada em dados usando **correlação parcial** ou **independência condicional**. A correlação parcial entre X e Y dado Z, $\rho_{XY \cdot Z}$, representa a correlação entre os **resíduos** de uma regressão de X em Z e os resíduos de uma regressão de Y em Z. Um valor próximo de zero para $\rho_{XY \cdot Z}$ corrobora a independência e, portanto, a d-separação.
> ![dag_1.png](/img/user/digital-garden/path-for-the-true-and-brave/assets/dag_1.png)
> [Estatística Psicobio II 2024 #24 - DAG II Directed Acyclic Graphs - d' separation; algoritmo PC e IC](https://www.youtube.com/watch?v=PD_891dshAE&list=PLZjaOxYREinu5j6wg-KEpD8xSdhRqEdwl&index=6&pp=iAQB)

# Termos de Classificação

![dag_2.jpg](/img/user/digital-garden/path-for-the-true-and-brave/assets/dag_2.jpg)
[Estatística Psicobio II 2024 #25 - DAG III - Aplicações do DAG, Propensity Scores e diff-n-diff](https://www.youtube.com/watch?v=mJ3tWzZESsU&list=PLZjaOxYREinu5j6wg-KEpD8xSdhRqEdwl&index=5)
Em um DAG, as variáveis podem ser caracterizadas pela sua posição relativa à Exposiçãoe ao Desfecho. Abaixo os tipos mais relevantes e as ações práticas recomendadas.

## Tipos de Variáveis
- Confundidor (confusão)
    Um ancestral tanto da exposição quanto do desfecho.
    - Cria um caminho não causal entre $X$ e $Y$, distorcendo o verdadeiro efeito de $X$ sobre $Y$.
    - Ação: É uma variável que devemos condicionar para **fechar** o caminho de confusão e obter uma estimativa não enviesada do efeito causal.
    - Estrutura: $\text{X} \leftarrow \text{V} \rightarrow \text{Y}$
- Mediador
    Um descendente da Exposição e um antecedente do Desfecho.
    - **Função:** Explica o mecanismo pelo qual $X$ afeta $Y$, estando no caminho causal de interesse.
    - Ação: Não devemos condicionar a variável mediadora se nosso objetivo é estimar o efeito total de $X$ sobre $Y$. Condicionar $V$ nos daria apenas o efeito direto de $X$ sobre $Y$.
    - **Estrutura:** $\text{X} \rightarrow \text{V} \rightarrow \text{Y}$
- Colisor
    - Um descendente tanto da Exposição quanto do Desfecho
    - **Função:** Por si só, **não** cria viés. O viés é induzid *apenas* quando **condicionamos** (incluímos na análise) o Colisor.
    - **Ação:** Não devemos condicionar o colisor. Condicionar um Colisor abre um caminho de viés, levando ao fenômeno chamado **viés de seleção** ou **viés do colisor**.
    - Estrutura: $\text{X} \rightarrow \text{V} \leftarrow \text{Y}$