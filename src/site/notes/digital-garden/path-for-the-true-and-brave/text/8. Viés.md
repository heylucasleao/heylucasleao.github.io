---
{"dg-publish":true,"permalink":"/digital-garden/path-for-the-true-and-brave/text/8-vies/"}
---

# Viés

O viés ocorre porque a variável de confusão cria uma **associação espúria** (falsa) entre o **Tratamento** (a Causa, A) e o **Resultado** (o Efeito, B). Isso acontece quando o Tratamento e o Resultado **compartilham uma causa comum** (a variável de confusão, C).
Em outras palavras, a variável de confusão (C) influencia:

1. A **probabilidade de receber o Tratamento** ($C \rightarrow A$).
2. O **Resultado de interesse** ($C \rightarrow B$).

Graficamente, a relação espúria é representada no **DAG (Modelo Gráfico Acíclico Direcionado)** como um caminho backdoor: $A \leftarrow C \rightarrow B$
Sem **controlar adequadamente** (ajustar ou condicionar) essa variável, a nossa estimativa do efeito de A em B incluirá o efeito indireto de C em B, fazendo parecer que A tem um efeito maior (ou menor) do que realmente tem.

> [!note] Leitura Recomendada
> [A Crash Course in Good and Bad Controls](https://ftp.cs.ucla.edu/pub/stat_ser/r493.pdf)
# Viés de seleção

Ocorre quando os participantes de um estudo são sistematicamente diferentes dos não participantes por questões que não podemos controlar completamente.

# Endogeneidade & Viés de variável omitida (OVB)

>[!tip] Leitura Recomendada
> [The anatomy of omitted variable bias - Robson Tigre](https://www.everydaycausal.com/causal-frameworks.html#sec-ovb)

A **Endogeneidade** ocorre quando uma variável explicativa em um modelo de regressão é correlacionada com o termo de erro ($\epsilon$). 

O **OVB** é uma das formas mais frequentes de endogeneidade. Ele surge quando omitimos do modelo uma variável $X_{omitida}$ que deveria estar presente. Para que essa omissão gere viés no coeficiente da variável de tratamento $D$, duas condições devem ser atendidas simultaneamente: 

- **Relevância para o Outcome:** A variável omitida deve ser um determinante de $Y$.
    
- **Correlação com o Tratamento:** A variável omitida deve estar correlacionada com a variável de tratamento $D$.

### Impacto no Modelo

Quando essas condições são atendidas, o efeito da variável omitida é "capturado" pelo termo de erro, tornando-o correlacionado com o tratamento. Matematicamente, o viés pode ser expressado como:

$$Bias = \beta_{omitida} \cdot \delta_{DX}$$

Onde $\beta_{omitida}$ é o efeito da variável omitida sobre $Y$, e $\delta_{DX}$ resulta da regressão da variável omitida contra o tratamento. Como consequência, o estimador de MQO torna-se viesado e inconsistente, falhando em capturar o verdadeiro efeito causal.

> [!tip] Nota
> Uma análise rápida de verificar uma variável de confusão sob isso é durante a análise exploratória utilizando `pairplot` da biblioteca Seaborn.
> Nela, conseguiremos ver se há uma correlação forte das covariáveis com o tratamento.
> 
> `sns.pairplot(data[["T", "C1", "C2", "C3"]], diag_kind="hist")`

## Derivação do Estimador de Mínimos Quadrados Ordinários (MQO)

Modelo verdadeiro $Y = \beta_0 + \beta_1 X_1 + \beta_2 X_2 + u$, onde $E[u] = 0$ e $\operatorname{Cov}(u, X_1) = \operatorname{Cov}(u, X_2) = 0$

Suponha que estimemos por MQO apenas $Y$ sobre $X_1$ (isto é, omitimos $X_2$). O estimador de MQO para o coeficiente de $X_1$ na regressão simples é  $\alpha_1 = \frac{\operatorname{Cov}(Y, X_1)}{\operatorname{Var}(X_1)}$. 

Substituindo o modelo verdadeiro em $\operatorname{Cov}(Y, X_1)$:  $\operatorname{Cov}(Y, X_1) = \operatorname{Cov}(\beta_0 + \beta_1 X_1 + \beta_2 X_2 + u, X_1) = \beta_1 \operatorname{Var}(X_1) + \beta_2 \operatorname{Cov}(X_2, X_1) + \operatorname{Cov}(u, X_1)$

Assumindo ($\operatorname{Cov}(u, X_1)=0$), temos: $\alpha_1 = \beta_1 + \beta_2 \frac{\operatorname{Cov}(X_2, X_1)}{\operatorname{Var}(X_1)}$

Portanto, o valor esperado do estimador é $E[\alpha_1] = \beta_1 + \beta_2 \frac{\operatorname{Cov}(X_2, X_1)}{\operatorname{Var}(X_1)}.$ 

O termo adicional $\beta_2 \dfrac{\operatorname{Cov}(X_2, X_1)}{\operatorname{Var}(X_1)}$ é o viés por omissão. Ele será diferente de zero sempre que:

- $\beta_2 \neq 0$ (ou seja, $X_2$ afeta $Y$) e
- $\operatorname{Cov}(X_2, X_1) \neq 0$ (ou seja, $X_2$ está correlacionada com $X_1$).

Em outras palavras: se $X_2$ é relevante para $Y$ e está correlacionada com $X_1$, então ao omiti-la o efeito de $X_2$ é parcialmente atribuído a $X_1$, enviesando $\alpha_1$.

>[!tip] Exemplo
>Podemos ver uma representação de OVB e como avaliar variáveis de controle em uma regressão a partir da aula ministrada em [Mastering Mostly Harmless Econometrics - Part 2](https://www.aeaweb.org/webcasts/2020/mastering-mostly-harmless-econometrics-part-2), a partir de 01:14:00.

