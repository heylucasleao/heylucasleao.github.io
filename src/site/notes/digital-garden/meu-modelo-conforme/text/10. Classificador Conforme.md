---
{"dg-publish":true,"permalink":"/digital-garden/meu-modelo-conforme/text/10-classificador-conforme/"}
---

# Classificador Conforme

Parab√©ns por chegar a este t√≥pico. Agora, vamos explorar a s√≠ntese de todos os conceitos discutidos anteriormente e apresentar uma vis√£o detalhada do modelo que criei. Certamente, pode haver conflitos conceituais. Caso ocorra, n√£o tenha medo de me comunicar. Objetivo desse di√°rio √© demonstrar minha linha de pensamento, e como cheguei at√© aqui.

O objetivo era desenvolver um modelo com alta adaptabilidade, flexibilidade e caracter√≠sticas espec√≠ficas oferecidas pelo RandomForest, incluindo:

- Capacidade de processar dados de alta dimensionalidade e extrair correla√ß√µes complexas.
- Habilidade de treinar modelos com dados de baixa frequ√™ncia.
- Robustez no tratamento de conjuntos de dados desbalanceados.
- Efici√™ncia computacional, permitindo treinamento e infer√™ncia r√°pidas.

Ao incorporar a calibra√ß√£o conformal (Venn-Abers), o modelo alcan√ßa:

- Regula√ß√£o precisa do score, transformando-o em uma medida verdadeiramente probabil√≠stica e mitigando riscos de overfitting.
- Maior confiabilidade nas previs√µes, essencial para aplica√ß√µes cr√≠ticas.

A implementa√ß√£o da Previs√£o Conforme proporciona:

- Aprimoramento significativo na interpretabilidade dos resultados do modelo.
- Estabelecimento de uma garantia de cobertura, permitindo controle preciso sobre a confian√ßa do modelo.
- Flexibilidade na modelagem do intervalo de predi√ß√£o, adapt√°vel a diferentes cen√°rios.
- Capacidade de quantificar a incerteza das previs√µes.

A integra√ß√£o de propriedades de Aprendizado Sens√≠vel ao Custo oferece:

- Versatilidade para lidar com diversos tipos de distribui√ß√µes de dados.
- Calibra√ß√£o baseada no custo de erro e n√£o somente performance.
- Capacidade de ajustar o modelo para minimizar custos em cen√°rios assim√©tricos de erro.

![image 7.png](/img/user/digital-garden/meu-modelo-conforme/assets/image%207.png)

## [Classificador Conforme Bin√°rio](https://github.com/HeyLucasLeao/cp-study/blob/master/models/hinge/cp.py)

Um diferencial que n√£o mencionei √© a utiliza√ß√£o de uma ideia baseada nos artigos [Venn Prediction for Survival Analysis](https://oa.upm.es/64515/1/TFM_IGNACIO_APARICIO_VAZQUEZ.pdf) e [Efficient Venn predictors using random forests](https://link.springer.com/article/10.1007/s10994-018-5753-x). Nessa abordagem, os dados n√£o utilizados no treinamento de cada √°rvore, conhecidos como amostras OOB (Out-of-Bag), s√£o empregados para gerar nossa cobertura. A ideia √© que teremos uma representatividade populacional de cada arvore de decis√£o. Em teoria, isso elimina a necessidade de uma base de calibra√ß√£o separada. No entanto, neste caso, utilizo esses dados para outro prop√≥sito.

√â importante ressaltar tamb√©m que transformo o conjunto de predi√ß√µes em uma √∫nica resposta: se o modelo tem certeza de que h√° apenas o r√≥tulo verdadeiro ou n√£o. Isso compromete a interpretabilidade do conjunto de predi√ß√µes do modelo. Conceitualmente, reconhe√ßo que isso pode ser question√°vel, mas o fa√ßo para obter flexibilidade na utiliza√ß√£o do Aprendizado Sens√≠vel a Custo. Vale notar que internamente ainda √© poss√≠vel recuperar essa informa√ß√£o.

### Calibra√ß√£o do Valor Œ±

Ap√≥s a cria√ß√£o do modelo conforme, ainda n√£o h√° uma defini√ß√£o clara do valor Œ±. Para determin√°-lo, calibro para o melhor resultado da acur√°cia balanceada em um intervalo de 0.01 a 0.10. O objetivo √© encontrar a melhor cobertura que permita ao modelo obter o menor custo de erro com uma garantia m√≠nima de 90%. Haver√° situa√ß√µes em que n√£o h√° raz√£o para reduzir Œ±, possibilitando seu estreitamento, enquanto em outras, o modelo poder√° ter uma efici√™ncia melhor com um aumento desse valor.

> [!tip] üí°
> Ao unir os tr√™s t√≥picos e calibrar o Œ±, estabelecemos um n√≠vel de signific√¢ncia que equilibra o custo entre falsos positivos e falsos negativos, evita overfitting e mant√©m uma distribui√ß√£o representativa para a cobertura.

### Avalia√ß√£o de Performance

Para certificar que tudo ocorreu bem com o modelo, verifico seu performance com dados de valida√ß√£o utilizando uma fun√ß√£o chamada `evaluate`. As m√©tricas que ele retorna s√£o:

```javascript
- "total": A quantidade total de dados utilizados para avalia√ß√£o.
- "alpha": O n√≠vel de signific√¢ncia estabelecido da cobertura.
- "empirical_coverage": A cobertura emp√≠rica dos conjuntos da Previs√£o Conforme.
- "one_c": A propor√ß√£o de conjuntos de predi√ß√£o contendo exatamente um elemento.
- "avg_c": O tamanho m√©dio dos conjuntos de predi√ß√£o.
- "empty": A propor√ß√£o de conjuntos de predi√ß√£o vazios.
- "error": A taxa de erro de classifica√ß√£o.
- "log_loss": A perda logar√≠tmica das predi√ß√µes.
- "ece": O erro de calibra√ß√£o esperado.
- "bm": O √≠ndice de informa√ß√£o do bookmaker.
- "mcc": O coeficiente de correla√ß√£o de Matthews.
- "f1": O F1-Score
- "fpr": A taxa de falsos positivos.
```

### Distribui√ß√£o Beta

![1000000056.png|Beta Distribution: Uses, Parameters & Examples](/img/user/digital-garden/meu-modelo-conforme/assets/1000000056.png)

A distribui√ß√£o Beta √© uma distribui√ß√£o de probabilidade cont√≠nua no intervalo [0, 1], ideal para observar e quantificar a incerteza na probabilidade do modelo. Sua fun√ß√£o de densidade de probabilidade √© definida por dois par√¢metros Œ± e Œ≤, que controlam a forma da distribui√ß√£o e permitem modelar diferentes tipos de incerteza probabil√≠stica. √â importante destacar que, devido ao rigor da Previs√£o Conforme, a cobertura segue naturalmente essa distribui√ß√£o, assegurando a confiabilidade do modelo. Embora n√£o seja estritamente necess√°rio analisar a Beta especificamente para este fim, n√£o discrimino o uso para an√°lises posteriores, como nos testes A/B.

## Refer√™ncia de meu Projeto

[https://github.com/HeyLucasLeao/cp-study/blob/master/cp.ipynb](https://github.com/HeyLucasLeao/cp-study/blob/master/cp.ipynb)
