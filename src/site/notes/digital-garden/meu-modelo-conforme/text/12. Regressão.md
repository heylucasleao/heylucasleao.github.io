---
{"dg-publish":true,"permalink":"/digital-garden/meu-modelo-conforme/text/12-regressao/"}
---

# Regressão

![image 8.png|Und,erstanding, Generating, and Evaluating Prediction Intervals](/img/user/digital-garden/meu-modelo-conforme/assets/image%208.png)

Na predição, estimamos resultados com base em dados históricos, assumindo que padrões passados podem nos ajudar a prever o futuro — sempre considerando um grau de incerteza. Na regressão, buscamos estimar um ponto específico. Por exemplo, na regressão linear, projetamos uma linha baseada em valores médios para obter o resultado desejado. Porém, estatisticamente, isso nos diz pouco: qual é o nível de incerteza do modelo? Que garantia temos de que minha casa realmente vale R$535.295? 

Em 1937, Jerzy Neyman introduziu o conceito de intervalos de confiança, argumentando que determinar um valor exato para um parâmetro populacional baseado em amostras tem utilidade limitada. É mais valioso estabelecer um intervalo de valores possíveis, com um nível de confiança definido de que o valor real esteja contido nele. Assim, podemos avaliar o grau de incerteza ao estimar um parâmetro. No contexto de previsão, este conceito é bastante relevante. A variabilidade e incerteza, sejam aleatórias ou epistêmicas, frequentemente dificultam a representação de todos os cenários possíveis. Por isso, quantificar a incerteza do modelo pode ser mais útil do que simplesmente fornecer um ponto médio. É aqui que entra a regressão quantílica: em vez de estimar um ponto médio, ela estima via quantil — o que é mais representativo para distribuições adversas de dados no dia a dia — permitindo-nos estimar duas previsões e utilizá-las como intervalo.

![image 9.png|Linear vs. Quantile Regression](/img/user/digital-garden/meu-modelo-conforme/assets/image%209.png)

![image 10.png|Linear vs. Quantile Regression](/img/user/digital-garden/meu-modelo-conforme/assets/image%2010.png)

Entretanto, a regressão quantílica não oferece garantia estatística de cobertura da previsão. Embora seja mais informativa, falta essa garantia formal. É nesse contexto que a previsão conforme se torna valiosa. Por exemplo, em vez de afirmar que minha casa vale R$535.295, posso apresentar um intervalo com 95% de confiança: entre R$515.629 e R$545.800. Mesmo sem um valor exato, tenho uma margem confiável do possível valor da casa e sei em qual faixa o modelo está seguro. Considere outro cenário: e se o intervalo fosse de R$480.000 a R$800.000? Tal amplitude indicaria claramente um problema no resultado. Seriam as características da minha casa que dificultam a previsão? A região onde moro influencia os preços? Ou o modelo está simplesmente incorreto? Todas essas análises se tornam possíveis ao examinar a amplitude do intervalo — algo que um valor pontual estimado jamais nos permitiria.

Após a criação do método de Previsão Conforme para classificação na minha biblioteca, aprendi muito sobre o método e o tema em geral. Com isso, decidi expandir o projeto, oferecendo suporte contínuo à biblioteca. Para aprofundar meu entendimento, implementei dois métodos de regressão usando ICP simples via divisão de dados de treino e calibração: o `ConformalizedRegression` e o `ConformalizedQuantileRegression`. 

![image 11.png|Exemplo de Intervalo com Dados Sintéticos](/img/user/digital-garden/meu-modelo-conforme/assets/image%2011.png)

A diferença maior é que `ConformalizedRegression` aceita um modelo de regressão normal baseado no [scikit-learn](https://github.com/scikit-learn/scikit-learn) , e o `ConformalizedQuantileRegression`(CQR), que aceita modelos que preditam intervalos quantílicos, baseado no  [quantile-forest](https://github.com/zillow/quantile-forest) . A razão disso é que originalmente, a regressão conforme foi introduzida criando intervalos com a previsão estimada do modelo. O único problema que devido a forma desse treino, é que o modelo original não é capaz de ser tão adaptivo com a distribuição dos dados, tornando o intervalo da previsão menos abrangente. Para sanar isso, o `ConformalizedQuantileRegressor` se torna melhor para essas previsões, devido ao modelo utiliza ser um modelo quantil que predita um intervalo de previsão, identificando intervalos mais adaptativos entre os dados. E sim, ambos aceitam geração da cobertura baseado em Out-Of-Bag (OOB).

![image 12.png|Theoretical Foundations of Conformal Prediction](/img/user/digital-garden/meu-modelo-conforme/assets/image%2012.png)
